# 测试框架说明 #

此说明文档介绍了测试框架（`run_test_harness.py`）中包含的测试内容。还有一些测试定义在 `tests.h` 中，并在 `main.cpp` 的 `main` 函数中列出。这些测试可以通过 `../part_*/runtasks` 二进制文件直接运行。

## SuperSuperLight ##
此测试分配了两个大小为 \(2^{15}\) 元素的缓冲区，并在每次迭代中简单地将一个缓冲区的元素复制到另一个缓冲区，同时反转复制顺序。共有 64 个任务和 400 次批量任务启动。

## SuperLight ##
此测试分配了两个大小为 \(2^{15}\) 元素的缓冲区，并交替顺序地将一个缓冲区的元素复制到另一个缓冲区。每个任务在复制数据到输出缓冲区之前，会先递增输入缓冲区中的值。共有 64 个任务和 400 次批量任务启动。

## PingPongEqual ##
此测试分配了两个大小为 \(2^{19}\) 元素的缓冲区，并交替顺序地将一个缓冲区的元素复制到另一个缓冲区。每个任务在复制数据到输出缓冲区之前，会先递增输入缓冲区中的值。任务间工作分配均匀。共有 64 个任务和 400 次批量任务启动。

## PingPongUnequal ##
此测试与 `PingPongEqual` 类似，但为某些任务分配了更多的工作量。

## RecursiveFibonacci ##
此测试通过一种计算密集型的递归方法计算一个斐波那契数。计算过程包括 30 次批量任务启动，每次启动有 256 个任务。

## MathOperationsInTightForLoop ##
此测试中的每个任务没有输入，执行 32 次计算密集型操作（包括指数、对数、乘法和加法操作）。每次计算的结果写入到输出数组的一个索引中。每次批量启动有 16 个任务，每次启动的输出数组大小为 512，共有 2000 次批量任务启动。在带有依赖的测试中，每个任务依赖于前一个任务。

## MathOperationsInTightForLoopFewerTasks ##
此测试与 `MathOperationsInTightForLoop` 类似，但将每次批量启动中的 512 个工作单元分配给 9 个任务。因此，每个任务分得更多的计算量，并且某些任务会略多于其他任务。

## MathOperationsInTightForLoopFanIn ##
此测试分为两种任务。第一种任务是与 `MathOperationsInTightForLoop` 相同的计算密集型数学操作。第二种任务是一个单独的加法归约操作，发生在末尾。归约操作依赖于所有的计算密集型数学任务。对于每次数学操作的批量启动，有 64 个任务写入大小为 2048 的数组，共有 256 次批量启动。归约操作对所有批量启动的输出向量进行向量求和，因此归约的输入是大小为 \(256 \times 2048\) 的向量，输出是大小为 2048 的向量。

## MathOperationsInTightForLoopReductionTree ##
此测试类似于 `MathOperationsInTightForLoopFanIn`，但归约操作不是单次加法归约，而是以二叉树结构执行的加法归约。每次加法归约操作的输入是两个批量任务启动的结果，输出是一个数组。对于数学操作，每次批量启动有 64 个任务写入大小为 16384 的数组，共有 32 次批量启动。每次加法归约操作的输入数组大小为 32768，输出数组大小为 16384。

## SpinBetweenRunCalls ##
首先启动一次包含一个轻量级任务的批量任务启动，该任务简单地将一个值复制到输出数组。然后启动两次中等权重任务的批量任务，这些任务通过递归方法计算第 40 个斐波那契数。最后再启动一次包含一个轻量级任务的批量任务启动。在异步模式下，最终任务依赖于前两个任务。

## MandelbrotChunked ##
此测试使用单次批量任务启动的 128 个任务，通过将问题分解为生成连续输出图像行块的任务，来计算 [Mandelbrot分形](https://en.wikipedia.org/wiki/Mandelbrot_set) 图像。每个任务的输入包括视图窗口的规格以及 Mandelbrot 分形算法的具体信息。输出是一个包含 Mandelbrot 分形图像的数组。计算本身非常密集。由于只进行一次批量任务启动，线程池和每次运行时生成线程的性能应类似。